/* Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.*/
(function(a){var b={function:!0,object:!0},c=b[typeof exports]&&exports&&!exports.nodeType&&exports,d=b[typeof self]&&self.Object&&self,e=b[typeof window]&&window&&window.Object&&window,f=b[typeof module]&&module&&!module.nodeType&&module,g=(f&&f.exports,c&&f&&"object"==typeof global&&global&&global.Object&&global),h=h=g||e!==(this&&this.window)&&e||d||this;"function"==typeof define&&define.amd?define(["./rx.core"],function(b,c){return a(h,c,b)}):"object"==typeof module&&module&&module.exports===c?module.exports=a(h,module.exports,require("./rx.core")):h.Rx=a(h,{},h.Rx)}).call(this,function(a,b,c,d){function e(a){var b=[];if(!V(a))return b;U.nonEnumArgs&&a.length&&W(a)&&(a=slice.call(a));var c=U.enumPrototypes&&"function"==typeof a,d=U.enumErrorProps&&(a===P||a instanceof Error);for(var e in a)c&&"prototype"==e||d&&("message"==e||"name"==e)||b.push(e);if(U.nonEnumShadows&&a!==Q){var f=a.constructor,g=-1,h=C;if(a===(f&&f.prototype))var i=a===R?L:a===P?H:M.call(a),j=T[i];for(;++g<h;)e=B[g],j&&j[e]||!N.call(a,e)||b.push(e)}return b}function f(a,b,c){for(var d=-1,e=c(a),f=e.length;++d<f;){var g=e[d];if(!1===b(a[g],g,a))break}return a}function g(a,b){return f(a,b,e)}function h(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}function i(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;var e=typeof a,f=typeof b;if(a===a&&(null==a||null==b||"function"!=e&&"object"!=e&&"function"!=f&&"object"!=f))return!1;var j=M.call(a),k=M.call(b);if(j==D&&(j=J),k==D&&(k=J),j!=k)return!1;switch(j){case F:case G:return+a==+b;case I:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case K:case L:return a==String(b)}var l=j==E;if(!l){if(j!=J||!U.nodeClass&&(h(a)||h(b)))return!1;var m=!U.argsObject&&W(a)?Object:a.constructor,n=!U.argsObject&&W(b)?Object:b.constructor;if(!(m==n||N.call(a,"constructor")&&N.call(b,"constructor")||isFunction(m)&&m instanceof m&&isFunction(n)&&n instanceof n||!("constructor"in a&&"constructor"in b)))return!1}c||(c=[]),d||(d=[]);for(var o=c.length;o--;)if(c[o]==a)return d[o]==b;var p=0,q=!0;if(c.push(a),d.push(b),l){if(o=a.length,p=b.length,q=p==o)for(;p--;){var r=b[p];if(!(q=i(a[p],r,c,d)))break}}else g(b,function(b,e,f){if(N.call(f,e))return p++,q=N.call(a,e)&&i(a[e],b,c,d)}),q&&g(a,function(a,b,c){if(N.call(c,b))return q=--p>-1});return c.pop(),d.pop(),q}function j(a,b){this.id=a,this.value=b}function k(a){this.predicate=a}function l(a){this.predicate=a}function m(a,b){var c=this;this.scheduler=a,this.messages=b,this.subscriptions=[],this.observers=[];for(var d=0,e=this.messages.length;d<e;d++){var f=this.messages[d],g=f.value;!function(b){a.scheduleAbsoluteWithState(null,f.time,function(){for(var a=c.observers.slice(0),d=0,e=a.length;d<e;d++)b.accept(a[d]);return q})}(g)}}var n=c.Observer,o=c.Observable,p=c.Disposable,q=p.empty,r=p.create,s=c.CompositeDisposable,t=c.SingleAssignmentDisposable,u=c.Scheduler,v=c.internals.ScheduledItem,w=c.internals.SchedulePeriodicRecursive,x=c.internals.inherits,y=c.helpers.notImplemented,z=c.helpers.defaultComparer=function(a,b){return X(a,b)},A=c.Notification=function(){function a(a,b,c,d,e,f){this.kind=a,this.value=b,this.exception=c,this._accept=d,this._acceptObservable=e,this.toString=f}return a.prototype.accept=function(a,b,c){return a&&"object"==typeof a?this._acceptObservable(a):this._accept(a,b,c)},a.prototype.toObservable=function(a){var b=this;return isScheduler(a)||(a=immediateScheduler),new AnonymousObservable(function(c){return a.scheduleWithState(b,function(a,b){b._acceptObservable(c),"N"===b.kind&&c.onCompleted()})})},a}(),B=(A.createOnNext=function(){function a(a){return a(this.value)}function b(a){return a.onNext(this.value)}function c(){return"OnNext("+this.value+")"}return function(d){return new A("N",d,null,a,b,c)}}(),A.createOnError=function(){function a(a,b){return b(this.exception)}function b(a){return a.onError(this.exception)}function c(){return"OnError("+this.exception+")"}return function(d){return new A("E",null,d,a,b,c)}}(),A.createOnCompleted=function(){function a(a,b,c){return c()}function b(a){return a.onCompleted()}function c(){return"OnCompleted()"}return function(){return new A("C",null,null,a,b,c)}}(),["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]),C=B.length,D="[object Arguments]",E="[object Array]",F="[object Boolean]",G="[object Date]",H="[object Error]",I="[object Number]",J="[object Object]",K="[object RegExp]",L="[object String]",M=Object.prototype.toString,N=Object.prototype.hasOwnProperty,O=M.call(arguments)==D,P=Error.prototype,Q=Object.prototype,R=String.prototype,S=Q.propertyIsEnumerable;try{!(M.call(document)==J&&!({toString:0}+""))}catch(a){!0}var T={};T[E]=T[G]=T[I]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},T[F]=T[L]={constructor:!0,toString:!0,valueOf:!0},T[H]=T["[object Function]"]=T[K]={constructor:!0,toString:!0},T[J]={constructor:!0};var U={};!function(){var a=function(){this.x=1},b=[];a.prototype={valueOf:1,y:1};for(var c in new a)b.push(c);for(c in arguments);U.enumErrorProps=S.call(P,"message")||S.call(P,"name"),U.enumPrototypes=S.call(a,"prototype"),U.nonEnumArgs=0!=c,U.nonEnumShadows=!/valueOf/.test(b)}(1);var V=c.internals.isObject=function(a){var b=typeof a;return a&&("function"==b||"object"==b)||!1},W=function(a){return!(!a||"object"!=typeof a)&&M.call(a)==D};O||(W=function(a){return!(!a||"object"!=typeof a)&&N.call(a,"callee")});var X=c.internals.isEqual=function(a,b){return i(a,b,[],[])},w=c.internals.SchedulePeriodicRecursive=function(){function a(a,b){b(0,this._period);try{this._state=this._action(this._state)}catch(a){throw this._cancel.dispose(),a}}function b(a,b,c,d){this._scheduler=a,this._state=b,this._period=c,this._action=d}return b.prototype.start=function(){var b=new t;return this._cancel=b,b.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this))),b},b}();j.prototype.compareTo=function(a){var b=this.value.compareTo(a.value);return 0===b&&(b=this.id-a.id),b};var Y=c.internals.PriorityQueue=function(a){this.items=new Array(a),this.length=0},Z=Y.prototype;Z.isHigherPriority=function(a,b){return this.items[a].compareTo(this.items[b])<0},Z.percolate=function(a){if(!(a>=this.length||a<0)){var b=a-1>>1;if(!(b<0||b===a)&&this.isHigherPriority(a,b)){var c=this.items[a];this.items[a]=this.items[b],this.items[b]=c,this.percolate(b)}}},Z.heapify=function(a){if(+a||(a=0),!(a>=this.length||a<0)){var b=2*a+1,c=2*a+2,d=a;if(b<this.length&&this.isHigherPriority(b,d)&&(d=b),c<this.length&&this.isHigherPriority(c,d)&&(d=c),d!==a){var e=this.items[a];this.items[a]=this.items[d],this.items[d]=e,this.heapify(d)}}},Z.peek=function(){return this.items[0].value},Z.removeAt=function(a){this.items[a]=this.items[--this.length],this.items[this.length]=d,this.heapify()},Z.dequeue=function(){var a=this.peek();return this.removeAt(0),a},Z.enqueue=function(a){var b=this.length++;this.items[b]=new j(Y.count++,a),this.percolate(b)},Z.remove=function(a){for(var b=0;b<this.length;b++)if(this.items[b].value===a)return this.removeAt(b),!0;return!1},Y.count=0;var $=c.VirtualTimeScheduler=function(a){function b(){return this.toDateTimeOffset(this.clock)}function c(a,b){return this.scheduleAbsoluteWithState(a,this.clock,b)}function d(a,b,c){return this.scheduleRelativeWithState(a,this.toRelative(b),c)}function e(a,b,c){return this.scheduleRelativeWithState(a,this.toRelative(b-this.now()),c)}function f(a,b){return b(),q}function g(f,g){this.clock=f,this.comparer=g,this.isEnabled=!1,this.queue=new Y(1024),a.call(this,b,c,d,e)}x(g,a);var h=g.prototype;return h.add=y,h.toDateTimeOffset=y,h.toRelative=y,h.schedulePeriodicWithState=function(a,b,c){return new w(this,a,b,c).start()},h.scheduleRelativeWithState=function(a,b,c){var d=this.add(this.clock,b);return this.scheduleAbsoluteWithState(a,d,c)},h.scheduleRelative=function(a,b){return this.scheduleRelativeWithState(b,a,f)},h.start=function(){if(!this.isEnabled){this.isEnabled=!0;do{var a=this.getNext();null!==a?(this.comparer(a.dueTime,this.clock)>0&&(this.clock=a.dueTime),a.invoke()):this.isEnabled=!1}while(this.isEnabled)}},h.stop=function(){this.isEnabled=!1},h.advanceTo=function(a){var b=this.comparer(this.clock,a);if(this.comparer(this.clock,a)>0)throw new ArgumentOutOfRangeError;if(0!==b&&!this.isEnabled){this.isEnabled=!0;do{var c=this.getNext();null!==c&&this.comparer(c.dueTime,a)<=0?(this.comparer(c.dueTime,this.clock)>0&&(this.clock=c.dueTime),c.invoke()):this.isEnabled=!1}while(this.isEnabled);this.clock=a}},h.advanceBy=function(a){var b=this.add(this.clock,a),c=this.comparer(this.clock,b);if(c>0)throw new ArgumentOutOfRangeError;0!==c&&this.advanceTo(b)},h.sleep=function(a){var b=this.add(this.clock,a);if(this.comparer(this.clock,b)>=0)throw new ArgumentOutOfRangeError;this.clock=b},h.getNext=function(){for(;this.queue.length>0;){var a=this.queue.peek();if(!a.isCancelled())return a;this.queue.dequeue()}return null},h.scheduleAbsolute=function(a,b){return this.scheduleAbsoluteWithState(b,a,f)},h.scheduleAbsoluteWithState=function(a,b,c){function d(a,b){return e.queue.remove(f),c(a,b)}var e=this,f=new v(this,a,d,b,this.comparer);return this.queue.enqueue(f),f.disposable},g}(u);k.prototype.equals=function(a){return a===this||null!=a&&("N"===a.kind&&this.predicate(a.value))},l.prototype.equals=function(a){return a===this||null!=a&&("E"===a.kind&&this.predicate(a.exception))};var _=c.ReactiveTest={created:100,subscribed:200,disposed:1e3,onNext:function(a,b){return"function"==typeof b?new aa(a,new k(b)):new aa(a,A.createOnNext(b))},onError:function(a,b){return"function"==typeof b?new aa(a,new l(b)):new aa(a,A.createOnError(b))},onCompleted:function(a){return new aa(a,A.createOnCompleted())},subscribe:function(a,b){return new ba(a,b)}},aa=c.Recorded=function(a,b,c){this.time=a,this.value=b,this.comparer=c||z};aa.prototype.equals=function(a){return this.time===a.time&&this.comparer(this.value,a.value)},aa.prototype.toString=function(){return this.value.toString()+"@"+this.time};var ba=c.Subscription=function(a,b){this.subscribe=a,this.unsubscribe=b||Number.MAX_VALUE};ba.prototype.equals=function(a){return this.subscribe===a.subscribe&&this.unsubscribe===a.unsubscribe},ba.prototype.toString=function(){return"("+this.subscribe+", "+(this.unsubscribe===Number.MAX_VALUE?"Infinite":this.unsubscribe)+")"},(c.MockDisposable=function(a){this.scheduler=a,this.disposes=[],this.disposes.push(this.scheduler.clock)}).prototype.dispose=function(){this.disposes.push(this.scheduler.clock)};var ca=function(a){function b(b){a.call(this),this.scheduler=b,this.messages=[]}x(b,a);var c=b.prototype;return c.onNext=function(a){this.messages.push(new aa(this.scheduler.clock,A.createOnNext(a)))},c.onError=function(a){this.messages.push(new aa(this.scheduler.clock,A.createOnError(a)))},c.onCompleted=function(){this.messages.push(new aa(this.scheduler.clock,A.createOnCompleted()))},b}(n);m.prototype.then=function(a,b){var e=this;this.subscriptions.push(new ba(this.scheduler.clock));var f,g=this.subscriptions.length-1,h=c.Observer.create(function(b){var i=a(b);if(i&&"function"==typeof i.then)f=i;else{var j=e.scheduler.clock;f=new m(e.scheduler,[c.ReactiveTest.onNext(j,d),c.ReactiveTest.onCompleted(j)])}var k=e.observers.indexOf(h);e.observers.splice(k,1),e.subscriptions[g]=new ba(e.subscriptions[g].subscribe,e.scheduler.clock)},function(a){b(a);var c=e.observers.indexOf(h);e.observers.splice(c,1),e.subscriptions[g]=new ba(e.subscriptions[g].subscribe,e.scheduler.clock)});return this.observers.push(h),f||new m(this.scheduler,this.messages)};var da=function(a){function b(a){var b=this;this.observers.push(a),this.subscriptions.push(new ba(this.scheduler.clock));var c=this.subscriptions.length-1;return r(function(){var d=b.observers.indexOf(a);b.observers.splice(d,1),b.subscriptions[c]=new ba(b.subscriptions[c].subscribe,b.scheduler.clock)})}function c(c,d){a.call(this,b);var e,f,g=this;this.scheduler=c,this.messages=d,this.subscriptions=[],this.observers=[];for(var h=0,i=this.messages.length;h<i;h++)e=this.messages[h],f=e.value,function(a){c.scheduleAbsoluteWithState(null,e.time,function(){for(var b=g.observers.slice(0),c=0,d=b.length;c<d;c++)a.accept(b[c]);return q})}(f)}return x(c,a),c}(o),ea=function(a){function b(a){var b,c,d=this;this.subscriptions.push(new ba(this.scheduler.clock));for(var e=this.subscriptions.length-1,f=new s,g=0,h=this.messages.length;g<h;g++)b=this.messages[g],c=b.value,function(c){f.add(d.scheduler.scheduleRelativeWithState(null,b.time,function(){return c.accept(a),q}))}(c);return r(function(){d.subscriptions[e]=new ba(d.subscriptions[e].subscribe,d.scheduler.clock),f.dispose()})}function c(c,d){a.call(this,b),this.scheduler=c,this.messages=d,this.subscriptions=[]}return x(c,a),c}(o);return c.TestScheduler=function(a){function b(a,b){return a>b?1:a<b?-1:0}function d(){a.call(this,0,b)}return x(d,a),d.prototype.scheduleAbsoluteWithState=function(b,c,d){return c<=this.clock&&(c=this.clock+1),a.prototype.scheduleAbsoluteWithState.call(this,b,c,d)},d.prototype.add=function(a,b){return a+b},d.prototype.toDateTimeOffset=function(a){return new Date(a).getTime()},d.prototype.toRelative=function(a){return a},d.prototype.startWithTiming=function(a,b,c,d){var e,f,g=this.createObserver();return this.scheduleAbsoluteWithState(null,b,function(){return e=a(),q}),this.scheduleAbsoluteWithState(null,c,function(){return f=e.subscribe(g),q}),this.scheduleAbsoluteWithState(null,d,function(){return f.dispose(),q}),this.start(),g},d.prototype.startWithDispose=function(a,b){return this.startWithTiming(a,_.created,_.subscribed,b)},d.prototype.startWithCreate=function(a){return this.startWithTiming(a,_.created,_.subscribed,_.disposed)},d.prototype.createHotObservable=function(){var a,b=arguments.length;if(Array.isArray(arguments[0]))a=arguments[0];else{a=new Array(b);for(var c=0;c<b;c++)a[c]=arguments[c]}return new da(this,a)},d.prototype.createColdObservable=function(){var a,b=arguments.length;if(Array.isArray(arguments[0]))a=arguments[0];else{a=new Array(b);for(var c=0;c<b;c++)a[c]=arguments[c]}return new ea(this,a)},d.prototype.createResolvedPromise=function(a,b){return new m(this,[c.ReactiveTest.onNext(a,b),c.ReactiveTest.onCompleted(a)])},d.prototype.createRejectedPromise=function(a,b){return new m(this,[c.ReactiveTest.onError(a,b)])},d.prototype.createObserver=function(){return new ca(this)},d}($),c});
//# sourceMappingURL=rx.core.testing.map